# ?????????? - rustshogi

## 1. board.rs: startpos()?????????
**????**: `src/rustshogi/board.rs` (158-362??)
**??**: `startpos()`??????200??????????`deploy()`???????????
**??**: 
- ????????????????????????
- ???????????????????????
- `deploy_starting_pieces()`????????

```rust
// ??: 200????deploy()????
// ??: ??????????
const STARTING_POSITION: &[(u8, u8, PieceType, ColorType)] = &[
    (1, 1, PieceType::Lance, ColorType::Black),
    // ...
];
```

---

## 2. board.rs: search_moves()?search_moves_no_cache()??????
**????**: `src/rustshogi/board.rs` (708-795??)
**??**: 2?????????????????????????????????
**??**: 
- ???????`search_moves_internal()`????????????????
- ????????????????????????????????

```rust
fn search_moves_internal(&self, color: ColorType) -> Vec<Move> {
    // ??????
}

pub fn search_moves(&self, color: ColorType) -> Vec<Move> {
    // ????????? + search_moves_internal()
}

pub fn search_moves_no_cache(&self, color: ColorType) -> Vec<Move> {
    search_moves_internal(color)
}
```

---

## 3. board.rs: to_string()?????????????
**????**: `src/rustshogi/board.rs` (495-539??)
**??**: ????????????????????????
**??**: 
- `format_hand_for_color()`?????????????????????

---

## 4. game.rs: ????????????????
**????**: `src/rustshogi/game.rs` (129-452??)
**??**: ?????????????????????:
- `random_move_parallel()`
- `random_move_sequential()`
- `random_move_parallel_chunked()`
- `random_move_parallel_thread_local()`
- `random_move_parallel_batched()`

**??**: 
- ??????????????????`execute_random_playout()`???????
- ??????enum???????????
- ???`random_move()`????????????????????

```rust
enum ParallelizationStrategy {
    Sequential,
    Parallel { num_threads: usize },
    Chunked { num_threads: usize, chunk_size: usize },
    // ...
}
```

---

## 5. evaluator/neural.rs: ???????????
**????**: `src/rustshogi/evaluator/neural.rs`
**??**: SQLite?PostgreSQL??????????????????
**??**: 
- `DatabaseConnection`???????enum???
- ???????????????
- `execute_query()`, `fetch_records()`????????????????

```rust
trait DatabaseConnection {
    fn init_table(&self) -> Result<(), Error>;
    fn insert_board(&self, board: &str) -> Result<(), Error>;
    // ...
}
```

---

## 6. search/alphabeta.rs ? minmax.rs: ?????
**????**: `src/rustshogi/search/alphabeta.rs` (78-134??) ? `minmax.rs` (65-112??)
**??**: `search()`?????????????????????????
**??**: 
- ?????`SearchStrategy`???????????????
- `get_default_evaluator()`??????????????

---

## 7. ??????: Python?????????????
**????**: ?????? (`board.rs`, `game.rs`, `moves.rs`??)
**??**: ???`python_*`?????????????
**??**: 
- PyO3?????????????????????????
- ?????????????????????

---

## 8. board.rs: execute_move()???????????
**????**: `src/rustshogi/board.rs` (797-838??)
**??**: `execute_move()`????????????????
**??**: 
- `promote_piece_type()`??????????????

```rust
fn promote_piece_type(piece_type: PieceType) -> PieceType {
    match piece_type {
        PieceType::Rook => PieceType::Dragon,
        PieceType::Bichop => PieceType::Horse,
        // ...
    }
}
```

---

## 9. evaluator/neural.rs: train_model()?????????
**????**: `src/rustshogi/evaluator/neural.rs` (537-841??)
**??**: `train_model()`??????300???????
**??**: 
- ???????`train_epoch()`???
- ??????`process_batch()`???
- ?????`display_progress()`???
- ?????????????????

---

## 10. board.rs: input_board()?SFEN???????
**????**: `src/rustshogi/board.rs` (364-404??)
**??**: SFEN?????????????
**??**: 
- SFEN??????`SfenParser`??????????????
- `parse_sfen_board()`, `parse_sfen_hand()`????????
